{{noteTA
|G1=IT
}}
{{编程范式}}
{{Expert|time=2015-12-14T03:33:42+00:00}}
{{Expand|time=2014-04-03T05:17:00+00:00}}

在[[计算机科学|计算机科学]]中，'''反射'''是指[[计算机程序|计算机程序]]在[[运行时|运行时]]（{{lang|en|Run time}}）可以访问、检测和修改它本身状态或行为的一种能力。<ref name="Forman_p8">见{{Harvnb|Forman|2005|p=8}}。</ref>用比喻来说，反射就是程序在运行的时候能够“观察”并且修改自己的行为。

要注意术语“反射”和“[[内省_(计算机科学)|内省]]”（{{lang|en|type introspection}}）的关系。内省（或称“自省”）机制仅指程序在运行时对自身信息（称为[[元数据|元数据]]）的检测；反射机制不仅包括要能在运行时对程序自身信息进行检测，还要求程序能进一步根据这些信息改变程序状态或结构。<ref name="Forman_p8"/>

== 历史背景 ==
最早的计算机在它们的原生汇编语言里编程，它本质上是反射，因为它是由定义编程指令作为数据。反射功能，如修改指令或分析它们是很平常的。编程迁移到更高层次的语言如C，这种实践消失了{{来源请求}}，直到带有反射特性的编程语言在它们的类型系统出现。

布莱恩·史密斯（Brian Cantwell Smith）在1982年的博士论文《编程语言中的步骤式反射》("Procedural Reflection in Programming Languages")中介绍了“编程语言的计算反射”概念，并且引入meta-circular解释器的概念用作3-Lisp的一个组成部分。

== 概况 ==
反射可以用于观察并修改程序在[[运行时|运行时]]的行为。一个面向反射的（reflection-oriented）程序组件可以监测一个范围内的[[代码|代码]]执行情况，可以根据期望的目标与此相关的范围修改本身。这通常是通过在运行时动态分配程序代码实现。

在[[面向对象程序设计|面向对象]]的[[编程语言|编程语言]]如[[Java|Java]]中，反射允许在编译期间不知道[[介面_(程式設計)|接口]]的名称，[[字段|字段]]（fields，即成员变量）、[[方法_(電腦科學)|方法]]的情况下在运行时检查类、接口、字段和方法。它还允许根据判断结果进行[[实例化|实例化]]新对象和不同方法的调用。

反射还可以使给定的程序动态地适应不同的运行情况。例如，考虑一个应用程序，它使用2个不同的类X和Y互相交替执行类似的操作。没有使用面向反射编程技术，应用程序可能是[[硬编码|硬编码]]的（即把代码写死，缺乏灵活性），以调用方法名称的类X和Y类。然而，使用面向反射的编程范式中，应用程序可以在设计和编写利用反射在没有硬编码方法名称情况下调用类中的方法X和Y。

反射也是[[元编程|元编程]]的一个关键策略。

== 示例 ==
{{expand section|time=2017-10-10}}

== 特点 ==
=== 优点 ===
支持反射的语言提供了一些在低级语言中难以实现的运行时特性。
* 可以在一定程度上避免硬编码，提供灵活性和通用性。<ref name="Forman_p4"/>
* 可以作为一个[[第一類物件|第一類物件]]发现并修改源代码的结构（如代码块、类、方法、协议等）。
* 可以在运行时像对待源代码语句一样计算符号语法的字符串（类似[[JavaScript|JavaScript]]的eval()函数），进而可将跟class或function匹配的字符串转换成class或function的调用或引用。
* 可以创建一个新的语言字节码解释器来给编程结构一个新的意义或用途。

=== 劣势 ===
* 此技术的学习成本高。面向反射的编程需要较多的高级知识，包括框架、关系映射和对象交互，以利用更通用的代码执行。
* 同样因为反射的概念和语法都比较抽象，过多地滥用反射技术会使得代码难以被其他人读懂，不利于合作与交流。<ref name="Forman_p4">见{{Harvnb|Forman|2005|p=4}}。</ref>
* 由于将部分信息检查工作从编译期推迟到了运行期，此举在提高了代码灵活性的同时，牺牲了一点点运行效率。<ref name="Forman_p4"/>

通过深入学习反射的特性和技巧，它的劣势可以尽量避免，但这需要许多时间和经验的积累。<ref name="Forman_p4"/>

== 常见应用 ==
* 反射经常作为[[软件测试|软件测试]]的一部分，比如运行时创建/实例化模拟对象。
* Java语言解析[[XML|XML]]文件的技术用到了反射。

== 参见 ==
* [[程序自修改|程序自修改]]
* [[反射式编程语言和平台列表|反射式编程语言和平台列表]]

== 参考资料 ==
=== 引用 ===
{{Reflist|refs=
}}

=== 来源 ===
* {{cite book |author=Ira R. Forman, Nate Forman |title=''Java Reflection in Action'' |trans_title=Java反射实战 |publisher=Manning Publications Co. |ISBN=1-932394-18-4 |edition=1 |language=en |ref={{sfnref|Forman|2005}} |date=2005年 |accessdate=2017年10月}}

==外部链接==
* {{cite web |author= |title=Reflection in logic， functional and object-oriented programming: a Short Comparative Study |url=http://citeseer.ist.psu.edu/106401.html |publisher=[[宾夕法尼亚州立大学|PSU]] [[Citeseer|Citeseer]]}}。

{{编程语言类别}}

{{DEFAULTSORT:Reflection}}
[[Category:編程典範|Category:編程典範]]