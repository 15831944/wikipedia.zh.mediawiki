{{NoteTA
|G1=IT
}}
[[File:Chain_of_trust.svg|lang=zh]]中作為{{tsl|en|Trust anchor|信任錨}}的起點角色]]
在[[密码学|密码学]]和[[计算机安全|计算机安全]]领域，'''根证书'''（'''root certificate'''）是屬於根[[数字证书认证机构|证书颁发机构]]（CA）的[[電子證書|公钥证书]]，是在[[公開金鑰基礎建設|公開金鑰基礎建設]]中，[[信任鏈|信任鏈]]的{{tsl|en|Trust anchor|信任锚|起點}}<ref name="rfc4158">{{Cite web|title={{RFC|4158}}|language=en|quote=all of the end entities and relying parties use a single "Root CA" as their trust anchor.  If the hierarchy has multiple levels, the Root CA certifies the public keys of intermediate CAs (also known as subordinate CAs).  These CAs then certify end entities' (subscribers') public keys or may, in a large PKI, certify other CAs.|publisher=[[IETF|IETF]]}}</ref>。证书颁发机构的角色有如现实世界中的[[公證行|公證行]]，保證網路世界中電子證書持有人的[[身分标识方式|身份]]。具體作法是透過[[公開金鑰認證#中介證書|中介證書]]，利用[[數位簽章|數位簽章]]為多個客戶签发多个不同的[[公開金鑰認證#終端實體證書|終端實體证书]]，形成一个以其根证书為顶层的[[樹狀結構|樹狀結構]]，在此[[传递关系|传递关系]]中所有下層證書都会因為根证书可被信赖而继承信任基礎。

根證書沒有上層機構再為其本身作數位簽章，所以都是{{tsl|en|Self-signed certificate|自簽證書}}。许多[[应用软件|应用软件]]（例如[[操作系统|操作系统]]、[[网页浏览器|网页浏览器]]）会預先安裝可被信任的根证书，這代表用戶授權了應用軟件代為審核哪些根憑證機構屬於可靠，例如是公認可靠的政府機關（如[[香港郵政|香港郵政]]<ref>{{cite web|url=https://www.hongkongpost.gov.hk/about/intro/index_c.html|publisher=香港郵政|title=關於香港郵政電子證書|quote=香港郵政在二零零零年成立香港第一家在《電子交易條例》（香港法例第553章）下的認可公共核證機關。現時，香港郵政核證機關發出符合電子交易條例要求的「認可數碼證書」。根據《電子交易條例》，使用該條例下認可的數碼證書作出的數碼簽署與書面的簽署具同等法律效力。}}</ref>）、專職機構（如[[Google|Google]]<ref>{{cite web|url=https://pki.goog/|title=Repository of Documentation and Certificates|publisher=Google Trust Services|language=en|quote=The Google Public Key Infrastructure (“Google PKI”), has been established by Google Trust Services, LLC (“Google”), to enable reliable and secure identity authentication, and to facilitate the preservation of confidentiality and integrity of data in electronic transactions.}}</ref>、[[Let's_Encrypt|Let's Encrypt]]、[[CAcert|CAcert.org]]、[[科摩多集团|Comodo]]、[[DigiCert|DigiCert]]、[[GlobalSign|GlobalSign]]、[[威瑞信|Verisign]]）等。應用軟件在[[握手_(技术)|建立安全連接時]]，例如使用网页浏览器造訪一個網站，会執行{{tsl|en|Certification path validation algorithm|認證路徑驗證演算法}}，使用該主機提供的電子證書，驗證是否能夠[[图的遍历|對應到]]預先安裝的根證書，從而验证從根證書到終端節點的路徑是否為一條有效的信任鏈，確保[[傳輸層安全協議|TLS]]安全连接中的身份。但是，这意味着用户信任浏览器的发布商、它所預先安裝的证书颁发机构，以及这些证书颁发机构可能颁发的所有中间证书颁发机构，相信他们忠诚地确保各证书持有人的身份和意图。

==鑰匙典禮==
{{main|{{tsl|en|Key ceremony|鑰匙典禮}}}}
憑證機構自簽一張新的根憑證時，需要產生一對公開金鑰及私有密鑰，這個過程在公證人、律師及錄影系統監察下經過一系列嚴謹的-{程序}-，在高度防護的設施內進行<ref>{{cite web|url=http://www.digi-sign.com/digi-ca/buyer/key+ceremony|language=en|title=Key Ceremony|publisher=Digi-Sign|quote=A Key Ceremony is only required when your organisation wishes to achieve your own independent root, or intermediate, Certificate Authority. This typically occurs where an organisation wants to create and own its own Root CA for reasons relating to compliance to specific standards (e.g. ISO 27001, WebTrust, EU Qualified Certificates, etc). A Root Key Ceremony is a procedure where a unique pair of Public and Private Root Keys is generated. Depending on your requirements and specifications, the generation of the Root Keys may require notarisation, legal representation, witnesses and "Key Holders" to be present}}</ref>。

==根憑證計劃==
由於根憑證在公開金鑰基礎建設擔任重要角色，負責任的憑證機構會公佈{{tsl|en|Certification Practice Statement|憑證作業準則}}以供公眾查閱，並負上法律責任<ref>{{cite web|url=https://letsencrypt.org/repository/|title=Policy and Legal Repository|publisher=[[Let's_Encrypt|Let's Encrypt]]|language=en}}</ref>。根證書一般會預先在不同的軟體廣泛部署，所以各大軟體商（如[[Mozilla|Mozilla]]<ref>{{cite web|url=https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/policy/|language=en|title=Mozilla Root Store Policy|publisher=[[Mozilla|Mozilla]]|quote=When distributing binary and source code versions of Firefox, Thunderbird, and other Mozilla-related software products, Mozilla includes with such software a set of X.509v3 root certificates for various Certification Authorities (CAs). The included certificates have their "trust bits" set for various purposes, so that the software in question can use the CA certificates to anchor a chain of trust for certificates used by SSL servers and S/MIME email users without having to ask users for further permission or information.}}</ref>、[[微软|微软]]<ref>{{cite web|url=https://technet.microsoft.com/en-us/library/cc751157.aspx?f=255&MSPPError=-2147217396|title=Microsoft Trusted Root Certificate: Program Requirements|language=en|publisher=[[微软|微软]]|quote=The Microsoft Trusted Root Certificate Program ("Program") supports the distribution of qualifying root certificates in Microsoft Windows and other Microsoft Products and Services.}}</ref>、[[蘋果公司|蘋果公司]]<ref>{{cite web|publisher=[[蘋果公司|蘋果公司]]|url=https://www.apple.com/certificateauthority/ca_program.html|title=Apple Root Certificate Program|language=en|quote=Apple uses public key infrastructure (PKI) to secure and enhance the experience for Apple users. Apple products, including our web browser Safari and Mail.app, use a common store for root certificates. Apple requires root certification authorities to meet certain criteria[...]}}</ref>、[[甲骨文公司|甲骨文公司]][[Java|Java]]<ref>{{cite web|url=http://www.oracle.com/technetwork/java/javase/javasecarootcertsprogram-1876540.html|title=Including Certificate Authority Root Certificates in Java|language=en|quote=In order to protect Oracle's Java SE customers from security issues related to the use of public key infrastructure  (PKI) certificates while enhancing their overall experience, Oracle requires that all root certificates authorities meet the following criteria before applying for inclusion of their root certificates in Oracle’s Java Runtime Environment (JRE).|publisher=[[甲骨文公司|甲骨文公司]]}}</ref>、[[Adobe_Systems|Adobe Systems]]<ref>{{cite web|url=https://helpx.adobe.com/acrobat/kb/approved-trust-list2.html|title=Adobe Approved Trust List|language=en|quote=Essentially, both Acrobat and Reader have been programmed to reach out to a web page to periodically download a list of trusted "root" digital certificates. Any digital signature created with a credential that can trace a relationship ("chain") back to the high-assurance, trustworthy certificates on this list is trusted by Acrobat and Reader.|publisher=[[Adobe_Systems|Adobe Systems]]}}</ref><ref>{{cite web|url=https://blogs.adobe.com/documentcloud/eu-trusted-list-now-available-in-adobe-acrobat/|title=EU Trusted List now available in Adobe Acrobat!|language=en|publisher=[[Adobe_Systems|Adobe Systems]]|quote=Adobe is delighted to announce the completion of our work to support and integrate the EU Trusted Lists (EUTL) into Adobe Acrobat and Acrobat Reader. For the first time, citizens, governments and businesses across the world will have easy access to electronically signed documents based on EU qualified certificates in the ubiquitous Adobe Acrobat and Acrobat Reader software.|date=2015-10-26}}</ref>）也發佈自己的審核標準，列明嚴謹的核認-{程序}-，例如行政人員的授權及機構法人身分的核認，才會部署於軟件產品，發放給大眾用戶安裝。而由於部署-{程序}-複雜費時，憑證機構發出的根憑證有效期可能長達十年以上。

在不少较为发达的国家和地区，都已立法承認數位簽章擁有等同親筆簽名的法律效力，並列出在法律上可被信任的根憑證（如[[欧洲联盟|欧洲联盟]]<ref>{{cite web|date=2017-05-09|publisher=[[欧洲联盟委员会|欧洲联盟委员会]]|url=https://ec.europa.eu/digital-single-market/en/eu-trusted-lists-trust-service-providers|title=EU Trusted Lists|language=en|quote=Under the Regulation (EC) No 910/2014/EU (eIDAS Regulation), national Trusted Lists have a constitutive effect. In other words, a trust service provider and the trust services it provides will be qualified only if it appears in the Trusted Lists. Consequently, the users (citizens, businesses or public administrations) will benefit from the legal effect associated with a given qualified trust service only if the latter is listed (as qualified) in the Trusted Lists.}}</ref><ref>{{cite web|url=http://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv:OJ.L_.2014.257.01.0073.01.ENG|title=REGULATION (EU) No 910/2014 OF THE EUROPEAN PARLIAMENT AND OF THE COUNCIL of 23 July 2014 on electronic identification and trust services for electronic transactions in the internal market and repealing Directive 1999/93/EC|publisher=EUR-Lex|language=en|quote=A qualified electronic signature shall have the equivalent legal effect of a handwritten signature.|date=2014-08-28}}</ref>、[[香港|香港]]<ref>{{cite web|url=https://www.ogcio.gov.hk/tc/regulation/eto/ordinance/ca_in_hk/|publisher=[[政府資訊科技總監辦公室|政府資訊科技總監辦公室]]|title=香港的認可核證機關|language=zh-HK|quote=核證機關在確保公開密碼匙基礎建設的有效運作方面擔當重要角色，並作為可信賴的第三方，負責證明電子交易所涉及有關各方的身分。目前，香港有兩間根據《電子交易條例》（第553章）獲得認可的核證機關。根據《電子交易條例》，郵政署署長是認可核證機關，提供香港郵政核證機關服務，而電子核證服務有限公司則是根據《電子交易條例》下核證機關自願認可計劃獲得認可的商營核證機關。|date=2017-06-30}}</ref><ref>{{cite web|url=https://www.ogcio.gov.hk/tc/regulation/eto/|date=2017-06-30|publisher=[[政府資訊科技總監辦公室|政府資訊科技總監辦公室]]|title=《電子交易條例》(第553章)|language=zh-HK|quote=政府於2000年1月制定《電子交易條例》(第553章)（「條例」），並於2004年6月作出修訂。大體上，條例旨在：賦予電子紀錄及電子簽署（請看下文的註釋1）跟紙張文件上的紀錄和簽署同等的法律地位；以及設立核證機關自願認可計劃以加強社會人士對電子交易的信心。（註釋1︰就不涉及政府單位的電子交易而言，任何形式的電子簽署，只要可靠恰當並獲簽署的接受人認同，已能符合法律有關簽署的規定。就涉及政府單位的電子交易而言，有認可數碼證書證明的數碼簽署，便符合法律上的簽署規定。）}}</ref>、[[中華民國|台灣]]<ref>{{cite web|url=http://law.moj.gov.tw/LawClass/LawAll.aspx?PCode=J0080037|title=電子簽章法|publisher=[[中華民國法務部|中華民國法務部]]全國法規資料庫工作小組|language=zh-TW|date=2001-11-14|quote=依法令規定應簽名或蓋章者，經相對人同意，得以電子簽章為之。}}</ref>）。

==自行安裝根證書==
[[File:Ubuntu-firefox-certificate-manager.png|thumb]]上[[Firefox|Firefox]]的電子證書管理用戶介面]]
雖然應用軟件會根據審核標準預載一系列可靠的根證書，但用戶仍然可以透過[[用户界面|介面]]自行增刪其電腦上所安裝並信任的根證書清單<ref>{{cite web|url=https://technet.microsoft.com/zh-tw/library/cc754841.aspx|title=管理受信任的根憑證|language=zh-TW|publisher=[[微軟|微軟]]|quote=某些組織可能會想要管理憑證信任，並避免網域中的使用者設定自己的信任根憑證集。此外，某些組織在需要額外信任關係的狀況下，會需要識別並分送特定的信任根憑證，以符合業務所需。}}</ref><ref>{{cite web|url=https://wiki.mozilla.org/PSM:Changing_Trust_Settings|title=PSM:Changing Trust Settings|language=en|date=2017-05-05|publisher=[[Mozilla|Mozilla]]|quote=This page describes how to change the default root certificate trust settings in Mozilla products, including Firefox and Thunderbird. [...] Some browsers only display the root certificates that the user has actually used, and dynamically download new ones on demand. However, Mozilla believes it is important for users to know the root certificates that could be used, so the full set of certificates is always shown. This also allows you to edit the trust bits for any root certificates that you do not want to use.}}</ref>。有時候，用戶連接某些網站時，會得到來自應用軟件（瀏覽器）的安全警告，但基於實際情況，仍然可能選擇信任網站，跳過警告以繼續；典型的例子是一般家用[[路由器|路由器]]，這些家用路由器的設定介面一般是以網頁形式在瀏覽器上執行，如果設定成為「以HTTPS連接」，則其原廠設定所使用的電子證書一般為自簽證書，即未經憑證機構數位簽章擔保，但用戶仍然可能選擇跳過警告，甚至在瀏覽器的信任根證書清單增加路由器的自簽證書，以便日後再設定時不必再收到瀏覽器的安全警告<ref name="mozilla-firefox-root-ca">{{cite web|url=https://support.mozilla.org/zh-TW/kb/troubleshoot-SEC_ERROR_UNKNOWN_ISSUER|title=排除在安全性網站上 "SEC_ERROR_UNKNOW_ISSUER" 的錯誤代碼|date=2016-06-29|publisher=[[Mozilla|Mozilla]]|quote=警告： 您永遠不該為合法的主要網站或金融交易網站增加憑證例外 - 此時無效的憑證可能表示您的連線正受到第三方的危害。如果允許，您可以增加例外以造訪網站，雖然它的憑證預設是不受信任的：在警告網頁，點擊 進階。點擊 增加例外…。將顯示 增加安全例外 對話框。閱讀敘述網站問題的文字。您可以點擊 檢視… 來更精確的檢視此不受信任的憑證。如果您確認您想信任些網站，點擊 確認安全例外。|language=zh-TW}} </ref>。另外一種情況，就是企業[[內部网|內部网]]的[[企业级软件|企业级软件]]，企業的資訊工程部門可能在員工的電腦上安裝了企業自行管理的根證書，使企業軟件不必倚賴外間第三者的憑證機構，而是可以自行擔當企業內部的憑證機構<ref>{{cite web|url=https://technet.microsoft.com/zh-tw/library/cc700804.aspx|title=在中小企業建立企業根憑證授權單位|quote=這份文件提供的指示可幫助您建立企業根 CA、使用憑證範本啟用自動註冊、為無線使用者建立自動註冊。您可以學到如何執行下列工作：安裝及設定企業根 CA。|language=zh-TW|publisher=[[微軟|微軟]]}}</ref>；但是這些根憑證可能未被廣泛認可，只在企業內部適用<ref>{{cite web|url=https://www.globalsign.com/en/blog/certificates-for-internal-servers/|title=SSL/TLS Certificates for Internal Servers|language=en|date=2016-09-29|publisher=[[GlobalSign|GlobalSign]]|quote=Enterprises can easily push out the necessary IntranetSSL non-public roots to their users via Group Policy Object (GPO), or other centralized management system which will make the IntranetSSL certificates trusted by their user community.}}</ref>。
===警告===
自行安裝根證書，或跳過應用軟件的安全警告，都可能會使用戶面對資訊安全風險，可能使應用軟件的保固條款失效，甚至使用戶的法律權益受損。尤其是在知名網站、銀行及政府機關等都不應有這種需要。請務必了解所要安裝的根證書的加密技術、所屬網站的真實身份及用戶的法律權責<ref name="mozilla-firefox-root-ca" />。
===截取通訊===
[[File:Man_in_the_middle_attack.svg|thumb]]
無論是出於企業為了保障網路安全<ref>{{cite web|url=https://www.paloaltonetworks.com/documentation/71/pan-os/pan-os/decryption/ssl-forward-proxy|title=SSL Forward Proxy|publisher=[[派拓网络|派拓网络]]|quote=The firewall uses certificates to establish itself as a trusted third party to the session between the client and the server [...] When the client initiates an SSL session with the server, the firewall intercepts the client SSL request and forwards the SSL request to the server. The server returns a certificate intended for the client that is intercepted by the firewall. If the server certificate is signed by a CA that the firewall trusts, the firewall creates a copy of the server certificate signs it with the firewall Forward Trust certificate and sends the certificate to the client [...] When the client authenticates the certificate, the SSL session is established with the firewall functioning as a trusted forward proxy to the site that the client is accessing. As the firewall continues to receive SSL traffic from the server that is destined for the client, it decrypts the SSL traffic into clear text traffic and applies decryption and security profiles to the traffic. The traffic is then re-encrypted on the firewall and the firewall forwards the encrypted traffic to the client.|language=en}}</ref><ref>{{cite web|url=https://www.juniper.net/documentation/en_US/junos-space16.2/topics/concept/junos-space-ssl-forward-proxy-overview.html|title=SSL Forward Proxy Overview|publisher=[[Juniper_Networks|Juniper Networks]]|date=2016-06-14|quote=SSL forward proxy is a transparent proxy; that is, it performs SSL encryption and decryption between the client and the server, but neither the server nor the client can detect its presence. SSL forward proxy ensures that it has the keys to encrypt and decrypt the payload|language=en}}</ref>、或為了[[竊聽|監控]]員工、或[[间谍软件|间谍软件]]和[[特洛伊木马_(电脑)|特洛伊木马]]為了竊取用戶資訊，只要有人得到用戶電腦的控制權，可以任意安裝根憑證，並且可以進行[[域名服务器缓存污染|域名服务器缓存污染]]或控制網路[[路由|路由]]，就可以進行[[中间人攻击|中间人攻击]]以解密用戶與遠端伺服器之間的安全連線<ref>{{cite web|language=en|author=Jeremy Schatten|url=https://www.ssltrust.com.au/blog/setup-squid-proxy/|title=Setup Squid Forward Proxy|date=2016-09-09|quote=In this configuration, the proxy is performing what in another context would be considered a man-in-the-middle attack. The client is completely unaware that somewhere their traffic is being sent is posing as the destination, decrypting their communication, and re-encrypting it to send to the real target server. Responses are captured on-the-fly as well, and sent back to the origin server. [...] It presents a certificate valid for any domain that it generates as requests hit it in real time, and because the client needs to be configured to trust the same root CA certificate the proxy uses, will allow the connection. (Remember, any certificate trusted as a root certificate can sign valid certificates for any and all domains and paths, not just its own.)}}</ref>，以下用[[愛麗絲與鮑伯|愛麗絲與鮑伯]]作範例：
# 假設[[愛麗絲與鮑伯|愛麗絲]]的電腦已在較早前被[[愛麗絲與鮑伯|馬洛里]]安裝了特定的根憑證，馬洛里擁有對應的私鑰
# 當愛麗絲嘗試與[[愛麗絲與鮑伯|鮑伯]][[握手_(技术)|建立安全連線時]]，馬洛里以[[代理服务器|代理服务器]]的身份先行收到連線請求
# 馬洛里暫時擱下愛麗絲的請求，轉而建立另一條連線向鮑伯請求他的電子證書
# 鮑伯的電子證書已得到一個受廣泛認可的認證機構數位簽章，如果馬洛里如實轉交給愛麗斯，一切都不會有問題
# 但馬洛里使用自己的私鑰簽發一個電子證書，證書上主體名稱聲稱是屬於鮑伯，並交給愛麗斯，而鮑伯不曾知道
# 愛麗斯驗證收到的電子證書，根據其信任鏈，她找到簽發的根證書
# 她發現自己的電腦中已安裝並信任這樣一個根證書，便信以為真，開始使用證書上的公鑰與鮑伯的秘密通訊
# 其實該根證書就是馬洛里早前安裝上去用以欺騙愛麗斯，這時馬洛里能夠利用自己的私鑰解密愛麗斯傳出的密文，並即時再用先前收到、鮑伯真正的電子證書上的公鑰再加密，並傳給鮑伯
# 鮑伯收到密文時不虞有詐，他能夠用自己的私鑰解密馬洛里傳送過來的密文
由此可見，愛麗斯與鮑伯都以為他們可以安全通訊，但卻不知道馬洛里可以在中間竊聽，甚至竄改通訊內容。

===防禦方法===
要避免中間人攻擊置換假冒的電子證書，HTTPS網站可以使用[[HTTP公钥固定|HPKP]]指明其固定的公鑰，讓中間人的欺詐證書無法使用。另外，憑證機構可以透過[[证书透明度|证书透明度]]公佈簽發的電子證書，讓大眾檢查手上收到的電子證書是否可能未被正式授權（中間人攻擊不會「公佈」他偽冒了別人簽發了欺詐證書），網站管理員也可以定期檢查是否有不明機構發出了未被授權的證書。而[[在线证书状态协议|OCSP]]和[[OCSP装订|OCSP装订]]也在發展中，讓用戶軟件可以透過第三方檢查證書是否有効。

==保護根憑證==
由於根憑證在信任鏈中的重要角色，一旦憑證機構的私鑰外洩，將可能導致整個信任鏈被摧毀，影響廣及眾多客戶，所以認證機構會使用各種方法保護根憑證，例如[[硬體安全模組|硬體安全模組]]。有些儲存私鑰的電腦甚至平時不會連線，只在固定的排程下，經過一系列嚴謹的行政程式重重把關，才會取出私鑰為客戶簽章憑證。在信任鏈設計中，絕大部份的根憑證都不會直接為客戶簽章，而是先簽章一個（或多個）[[中繼憑證|中繼憑證]]，再由中繼憑證為客戶簽章，這可以加強控管能力及控制一旦簽章私鑰被洩時的損失<ref>{{cite web|url=https://hk.godaddy.com/help/what-is-an-intermediate-certificate-868|title=什麼是中間憑證？|language=zh-TW|quote=中間憑證為我們根憑證的替身。由於我們必須將我們的根憑證置於數層安全防護之後，因此我們利用中間憑證作為 proxy，確保根憑證的密鑰絕對無法被存取。但是，由於根憑證本身簽署了中間憑證，中間憑證可以被用來簽署我們的客戶安裝與維護的「信任連鎖」 SSL。|publisher=[[GoDaddy|GoDaddy]]}}</ref><ref>{{cite web|url=https://security.stackexchange.com/questions/24896/how-do-certification-authorities-store-their-private-root-keys|title=How do certification authorities store their private root keys?|language=en|publisher=[[Stack_Exchange|Stack Exchange]]|quote=For extra recovery, the CA is often split into a long-lived root CA which is kept offline, and a short-lived intermediate CA. Both machines are in the cage and bunker; the root CA is never connected to a network. The root CA is physically accessed, with dual control (at least two people together, and video recording) on a regular basis, to emit the certificate for the intermediate CA}}</ref>。

== 参考资料 ==
{{Reflist|30em}}

{{TLS和SSL}}

[[Category:傳輸層安全協議|Category:傳輸層安全協議]]
[[Category:公钥加密|Category:公钥加密]]
[[Category:密钥管理|Category:密钥管理]]
[[Category:公钥基础设施|Category:公钥基础设施]]